@model IEnumerable<TheRelieverMap.Models.AddToilet>
@{
    ViewBag.Title = "MyToilet";
}

<h2>My Facilities</h2>

<ul>
    @foreach (var toilet in Model)
    {
        <li>
            <div class="toilet-name">
                @toilet.Name
            </div>

            <div class="toilet-type">
                @toilet.Type.Name
            </div>

            <div class="state">
                @toilet.State.Name
            </div>
            
            <div class="city">
                @toilet.City
            </div>

            <div class="address">
                @toilet.Address
            </div>

            <div class="compatible">
                @toilet.Compatibility.Name
            </div>
            <div>
                <span><a href="@Url.Action("Edit", "AddToilet", new {id = toilet.Id})">Edit</a></span> |
                <span><a href="#" class="js-cancel-toilet" data-toilet-id="@toilet.Id">Delete</a></span>
            </div>
            <br />

        </li>
    }
</ul>

@section scripts
{
    <script>
        $(document).ready(function () {
            $(".js-cancel-toilet").click(function (e) {
                var link = $(e.target);

                if (confirm("Are you sure you want to delete this service?")) {
                    $.ajax({
                        url: "/api/deletetoilet/" + link.attr("data-toilet-id"),
                        method: "DELETE"
                    })
                        .done(function () {
                            link.parents("li").fadeOut(function () {
                                $(this).remove();
                            });
                        })
                        .fail(function () {
                            alert("Something Failed");
                        });
                }
            });
        });
    </script>
}